//2013-6-7
if(typeof(TQKF)=="undefined"){TQKF={}}if(typeof(tq_clientid)=="undefined"){tq_clientid=""}if(typeof(tq_minimess_selectable_inputs)=="undefined"||tq_minimess_selectable_inputs=="")var tq_minimess_selectable_inputs="message|1||name|0||mobile|0||phone|0";TQKF._MessResource={cn:{title:"%u6B22%u8FCE%u8054%u7CFB%u6211%u4EEC",messageTip:"%u8BF7%u5728%u6B64%u7559%u8A00%uFF0C%u6211%u4EEC%u4F1A%u53CA%u65F6%u8054%u7CFB%u60A8%uFF0C%u8C22%u8C22%uFF01",call:tq_minimess_style=="2"?"%u514D%u8D39%u7535%u8BDD":"",send:tq_minimess_style=="2"?"%u53D1%u9001%u7559%u8A00":"",prefix:"%u8BF7%u586B%u5199",tipprefix:"%u8BF7%u586B%u5199",sendding:"%u6B63%u5728%u53D1%u9001%uFF0C%u8BF7%u7A0D%u5019...",calling:"%u6B63%u5728%u547C%u53EB%uFF0C%u8BF7%u7B49%u5F85%u7535%u8BDD%u9707%u94C3...",success:"%u7559%u8A00%u6210%u529F%uFF01",callsuccess:"%u547C%u53EB%u6210%u529F%uFF0C%u6B22%u8FCE%u4E0B%u6B21%u4F7F%u7528%uFF01",fail:"%u7559%u8A00%u53D1%u9001%u5931%u8D25%uFF0C",callFail:"%u547C%u53EB%u5931%u8D25%uFF0C",copyright:"",href:(typeof(tq_homepage)=="undefined"||tq_homepage=='')?("http://weibo.com/tqcn?m=tqpf_"+tq_adminid):tq_homepage,inputTip:["%u7559%u8A00%u5185%u5BB9","%u59D3%u540D","%u90AE%u7BB1","%u7535%u8BDD%28%u5982%3A01088888888%29","%u624B%u673A","%u5730%u5740","%u7C7B%u578B%3A"],optionText:["%u54A8%u8BE2","%u6295%u8BC9","%u5EFA%u8BAE"],errorMsg:{notEmpty:"${tip}%u4E0D%u80FD%u4E3A%u7A7A",tooLong:"${tip}%u4E0D%u80FD%u8D85%u8FC7%u4E2A${maxLen}%u5B57%u7B26",invalid:"%u8BF7%u586B%u5199%u6B63%u786E%u7684${tip}",phoneEmpty:"%u8BF7%u586B%u5199%u6B63%u786E%u7684%u624B%u673A%u53F7%u6216%u7535%u8BDD"},serverErrorMsg:{m1:"%u975E%u6CD5%u8BF7%u6C42%uFF01",m2:"%u8BF7%u6C42%u7684TQ%u53F7%u7801%u4E3A%u7A7A%u3002",m3:"%u586B%u5199%u7684%u7535%u8BDD%u53F7%u7801%u9519%u8BEF%u3002",m4:"%u65E0%u8BE5%u7528%u6237%u670D%u52A1%u4FE1%u606F%u3002",m5:"%u5BF9%u65B9%u5C1A%u672A%u5F00%u901A%u514D%u8D39%u7535%u8BDD%u56DE%u547C%u4E1A%u52A1%u3002",m6:"%u5BF9%u65B9%u7684%u514D%u8D39%u7535%u8BDD%u4F59%u989D%u4E0D%u8DB3%u3002",m7:"%u672A%u77E5%u9519%u8BEF%u3002",m8:"%u547C%u53EB%u5931%u8D25%u3002",m9:"%u5BF9%u65B9%u7684%u53F7%u7801%u4E0D%u5728%u670D%u52A1%u65F6%u95F4%u3002",m10:"%u5BF9%u65B9%u7684%u7535%u8BDD%u5FD9%u3002",m11:"%u547C%u53EB%u8D85%u65F6%u3002",m12:"%u7CFB%u7EDF%u5FD9%u3002",m13:"%u5206%u53D1%u7684%u6700%u7EC8%u670D%u52A1%u53F7%u7801%u672A%u8BBE%u7F6E%u3002",m14:"%u8BF7%u6C42%u7535%u8BDD%u6709%u8BEF%u3002",m15:"%u7CFB%u7EDF%u9519%u8BEF%u3002",m16:"%u60A8%u6240%u586B%u5199%u7684%u7535%u8BDD%u62D2%u7EDD%u63A5%u542C",m17:"%u5BF9%u65B9%u5C1A%u672A%u5F00%u901A%u514D%u8D39%u7535%u8BDD%u56DE%u547C%u4E1A%u52A1%u3002",m18:"%u5BF9%u65B9%u7684%u514D%u8D39%u7535%u8BDD%u5E10%u53F7%u5DF2%u7ECF%u6682%u505C%u4F7F%u7528%u3002",m19:"%u5BF9%u65B9%u7684%u514D%u8D39%u7535%u8BDD%u4F59%u989D%u4E0D%u8DB3%u3002",m20:"%u5BF9%u65B9%u7684%u514D%u8D39%u7535%u8BDD%u76EE%u524D%u4E0D%u53EF%u7528%u3002",m31:"%u89E3%u6790%u7559%u8A00%u5185%u5BB9%u51FA%u9519%u3002",m32:"%u53C2%u6570%u4E0D%u8DB3%u3002",m33:"%u53C2%u6570%u4E0D%u5408%u6CD5%u3002",m34:"%u7528%u6237%u4E0D%u5B58%u5728%u3002",m35:"%u7528%u6237%u540D%u4E0D%u5B58%u5728%u3002",m36:"%u8F93%u5165%u7684%u53F7%u7801%u4E0D%u5408%u6CD5%u3002",m37:"%u65E0%u8BE5%u7528%u6237%u670D%u52A1%u4FE1%u606F%u3002",m38:"%u5199%u5165%u7559%u8A00%u5931%u8D25%u3002",munknown:"%u672A%u77E5%u9519%u8BEF%u3002"}},en:{title:"Mini message",messageTip:"Enter your Message here,and we will contact you later",call:tq_minimess_style=="2"?"Free Call":"",send:tq_minimess_style=="2"?"Send":"",prefix:"Please fill in ",tipprefix:"Please fill in ",sendding:"Sendding...",calling:"Calling now, waiting for the phone ringing...",success:"Sent successfully",callsuccess:"Call success",fail:"Send message failed",callFail:"Call Error",copyright:"",href:(typeof(tq_homepage)=="undefined"||tq_homepage=='')?"http://www.tq.cn?minimess_en":tq_homepage,inputTip:["Message","Name","Email","Phone","Mobile","Address",""],optionText:["Consult","Complain","Advice"],errorMsg:{notEmpty:"${tip} can not be empty",tooLong:"max length of ${tip} is ${maxLen} words",invalid:"${tip} format invalid",phoneEmpty:"Please fill in the phone number or mobile"},serverErrorMsg:{m31:"Parsing message error .",m32:"Insufficient parameters.",m33:"Parameter is not valid.",m34:"The user does not exist.",m35:"User name does not exist.",m36:"Enter the number of illegal.",m37:"Without service information of the user.",m38:"Write message fails.",munknown:"Unknown error."}}};if(typeof(tq_adminid)=="undefined"){tq_adminid=strUin;tq_language=tq_ltype=="100"?"2":"1";tq_encode=utf8=="1"?"utf8":"gbk"}if(tq_language==1)TQKF.MessResource=TQKF._MessResource.cn;else TQKF.MessResource=TQKF._MessResource.en;TQKF.MessConfig={style:"1",color:"2",title:unescape(TQKF.MessResource.title),position:"RD",message_tip:unescape(TQKF.MessResource.messageTip),isAutoShow:1,isAutoHide:0,autoHideDelay:2000,tipAutoHideDelay:2000,isToggleByClickTitle:1,isCanClose:0,isShowCallBtnEn:1,postAction:TQKF.vip_server_url+"/vip/minimess.do",sendingImg:'images/minimess/s'+tq_minimess_style+'/ajax-loader.gif',errorImg:'images/minimess/s'+tq_minimess_style+'/error.gif',successImg:'images/minimess/s'+tq_minimess_style+'/ok.gif',warningImg:'images/minimess/s'+tq_minimess_style+'/warning.gif',inputs:[],custom_inputs:"",_inputs:[{type:"textarea",classs:"TQMiniMessMessage",tip:unescape(TQKF.MessResource.inputTip[0]),idname:"message",maxLen:200,isMust:1,isValidate:0},{type:"text",classs:"TQMiniMessName",tip:unescape(TQKF.MessResource.inputTip[1]),idname:"name",maxLen:50,isMust:0,isValidate:0},{type:"text",classs:"TQMiniMessEmail",tip:unescape(TQKF.MessResource.inputTip[2]),idname:"email",maxLen:50,isMust:0,isValidate:1},{type:"text",classs:"TQMiniMessPhone",tip:unescape(TQKF.MessResource.inputTip[3]),idname:"phone",maxLen:15,isMust:0,isValidate:1},{type:"text",classs:"TQMiniMessMobile",tip:unescape(TQKF.MessResource.inputTip[4]),idname:"mobile",maxLen:14,isMust:0,isValidate:1},{type:"text",classs:"TQMiniMessAddress",tip:unescape(TQKF.MessResource.inputTip[5]),idname:"address",maxLen:100,isMust:0,isValidate:0},{type:"select",classs:"TQMiniMessMessagetype",tip:unescape(TQKF.MessResource.inputTip[6]),idname:"messagetype",option:[{value:100,text:unescape(TQKF.MessResource.optionText[0])},{value:102,text:unescape(TQKF.MessResource.optionText[2])},{value:103,text:unescape(TQKF.MessResource.optionText[1])}]}],addSelectalbeToInputs:function(){if(typeof(tq_minimess_selectable_inputs)=="undefined"||tq_minimess_selectable_inputs=="")this.inputs=this._inputs;else{var sInputs=tq_minimess_selectable_inputs.split("||");for(var i=0;i<sInputs.length;i++){sInputs[i]=sInputs[i].split("|")}for(var i=0;i<sInputs.length;i++){for(var j=0;j<this._inputs.length;j++){if(this._inputs[j].idname==sInputs[i][0]){if(sInputs[i][1])this._inputs[j].isMust=parseInt(sInputs[i][1]);if(sInputs[i][2])this._inputs[j].isValidate=parseInt(sInputs[i][2]);this.inputs.push(this._inputs[j]);continue}}}}},addCustomToInputs:function(){if(this.custom_inputs=="")return;var temp=eval(this.custom_inputs);for(var i=0;i<temp.length;i++){var input=temp[i];input.type="text";input.innertip=unescape(TQKF.MessResource.tipprefix+input.tip);input.idname="custom"+i;input.classs="TQMiniMessOther";input.isValidate=0;this.inputs.push(input)}}};TQUtils.SetConfigValue("tq_minimess_",TQKF.MessConfig);TQKF.MessConfig.addSelectalbeToInputs();TQKF.MessConfig.addCustomToInputs();TQKF.mess={FORM_NAME:"TQMiniMessForm",WRAP_ID:"TQMiniMessWrap",HEAD_ID:"TQMiniMessHead",TITLE_ID:"TQMiniMessTitle",HEAD_ICON_ID:"TQMiniMessHeadIcon",BODY_ID:"TQMiniMessBody",BODY_TOP_ID:"TQMiniMessBodyTop",BODY_MID_ID:"TQMiniMessBodyMid",BODY_BOTTOM_ID:"TQMiniMessBodyBottom",BODY_FOOT_ID:"TQMiniMessBodyFoot",SUBMIT_ID:tq_language==1?"TQMiniMessSubmit":"TQMiniMessSubmitEn",CALL_ID:tq_language==1?"TQMiniMessCall":"TQMiniMessCallEn",COPY_ID:"TQMiniMessCopy",FRAME_ID:"TQMiniMessCopyFrame",TIP_CLASS:"TQMiniMessTip",ICON_OPEN_CLASS:"TQMiniMessIconOpen",ICON_CLOSE_CLASS:"TQMiniMessIconClose",SEND_INFO_BG_ID:"TQMiniMessSendInfoBG",SEND_INFO_CTNER_ID:"TQMiniMessSendInfoCtner",SEND_INFO_DIV_ID:"TQMiniMessSendInfoDIV",SEND_INFO_IMG_ID:"TQMiniMessSendImg",SEND_INFO_WORD_ID:"TQMiniMessSendWord",PREFIX:"TQMiniMess_",submittype:"call",adminid:tq_adminid,uin:tq_adminid,tactic_id:typeof(tq_minimess_tactic)=="undefined"?"":tq_minimess_tactic,siteid:typeof(tq_siteid)=="undefined"?"":tq_siteid,hideTipTimer:null,DOM:{mbWrap:null,create:function(){if(this.mbWrap!=null)return;this.mbWrap=document.createElement("div");this.mbWrap.className="TQMiniMess_common";this.mbWrap.id=TQKF.mess.WRAP_ID;this.mbWrap.style.visibility="visible";this.mbWrap.style.display="";this.mbWrap.style.top="1000px";if(TQKF.MessConfig.position&&TQKF.MessConfig.position.indexOf('L')==0)this.mbWrap.style.left="0px";else this.mbWrap.style.right="0px";var html=[];html.push('<div id=${TQKF.mess.SEND_INFO_BG_ID} class="TQMiniMess_common"></div>','<div id=${TQKF.mess.SEND_INFO_CTNER_ID} class="TQMiniMess_common"><table cellspacing="0" cellpadding="0" style="margin:0; width:100%;height:100%;border-style: solid; border-width: 0px; padding: 0; text-align:center; text-indent:0; word-spacing:0; line-height:100%" class="TQMiniMess_common"><tr><td align=center><div id=${TQKF.mess.SEND_INFO_DIV_ID} class="TQMiniMess_common" onclick="TQKF.mess.DOM.hideTip()"><table cellspacing="0" cellpadding="0" class="TQMiniMess_common" style="margin:0; width:100%;height:100%;border-style: solid; border-width: 0px; padding: 5px; text-align:center; text-indent:0; word-spacing:0; line-height:100%"><tr><td><img id=${TQKF.mess.SEND_INFO_IMG_ID} border="0" src="${TQKF.image_url}${TQKF.MessConfig.sendingImg}"></td><td id=${TQKF.mess.SEND_INFO_WORD_ID}></td></tr></table></div></td></tr></table></div>','<div id="${TQKF.mess.HEAD_ID}" class="TQMiniMess_common">','<div id="${TQKF.mess.TITLE_ID}" class="TQMiniMess_common">${TQKF.MessConfig.title}</div>','<div class="TQMiniMess_common ${TQKF.mess.ICON_OPEN_CLASS}" id="${TQKF.mess.HEAD_ICON_ID}"></div>','</div>','<div id="${TQKF.mess.BODY_ID}" class="TQMiniMess_common">','<div id="${TQKF.mess.BODY_TOP_ID}" class="TQMiniMess_common"></div>','<div id="${TQKF.mess.BODY_MID_ID}" class="TQMiniMess_common"></div>','<div id="${TQKF.mess.BODY_BOTTOM_ID}" class="TQMiniMess_common">','<input type="button" id=${TQKF.mess.CALL_ID}'+(tq_iscallback==1?'':' style="display:none"')+' value="${TQKF.MessResource.call}" onclick="TQKF.mess.submittype=\'call\';TQKF.mess.validate.init();" /><input id="${TQKF.mess.SUBMIT_ID}" type="button" value="${TQKF.MessResource.send}" onclick="TQKF.mess.submittype=\'message\';TQKF.mess.validate.init();">','<a href=${TQKF.MessResource.href} target=_blank><div id="${TQKF.mess.COPY_ID}" class="TQMiniMess_common">${TQKF.MessResource.copyright}</div></a>','</div>','<div id="${TQKF.mess.BODY_FOOT_ID}" class="TQMiniMess_common"></div>','</div>');this.mbWrap.innerHTML=html.join('').replace(/\$\{[.\w]+\}/g,this.parseVM)},append:function(){TQUtils.AppendDOM(TQKF.mess.DOM.mbWrap)},parseVM:function(str){if(str.indexOf('$')==0){try{return unescape(eval(str.substr(2,str.length-3)))}catch(e){return''}}return str},createFormInputs:function(){var mbBody=TQUtils.GetObj(TQKF.mess.BODY_ID);var mbBodyMid=TQUtils.GetObj(TQKF.mess.BODY_MID_ID);for(var i=0,l=TQKF.MessConfig.inputs.length;i<l;i++){var inputCfg=TQKF.MessConfig.inputs[i];if(inputCfg.idname!="messagetype"){if(inputCfg.tip){var tipEl=document.createElement('div');tipEl.className=TQKF.mess.TIP_CLASS;tipEl.innerHTML=inputCfg.tip;mbBodyMid.appendChild(tipEl)}var inputWrap=document.createElement('div');var inputEl;if(inputCfg.type=='text'){inputEl=document.createElement('input');inputEl.type='text'}else if(inputCfg.type=='select'){inputEl=document.createElement('select')}else{inputEl=document.createElement('textarea')}var maxLen=inputEl.maxLen;if(typeof(inputEl.maxLen)=="undefined")inputEl.maxLen=500;if(inputCfg.idname){inputEl.name=TQKF.mess.PREFIX+inputCfg.idname;inputEl.id=TQKF.mess.PREFIX+inputCfg.idname}if(inputCfg.classs){inputWrap.className=inputCfg.classs}if(inputCfg.idname=="message")this.__addInputEvent(inputEl,TQUtils.FillInnertip(TQKF.MessConfig.message_tip));else this.__addInputEvent(inputEl,TQUtils.FillInnertip(unescape(TQKF.MessResource.tipprefix)+inputCfg.tip));inputWrap.appendChild(inputEl);mbBodyMid.appendChild(inputWrap)}}for(var i=0,l=TQKF.MessConfig.inputs.length;i<l;i++){var inputCfg=TQKF.MessConfig.inputs[i];if(inputCfg.idname=="messagetype"){var inputWrap=document.createElement('div');inputWrap.innerHTML=inputCfg.tip;var radioHTML="";for(var j=0;j<inputCfg.option.length;j++){radioHTML+="<input "+(j==0?" checked ":"")+"style=\"width:20px;margin:0 0 0 0;height:10px\" id=\""+TQKF.mess.PREFIX+inputCfg.idname+"\" name=\""+TQKF.mess.PREFIX+inputCfg.idname+"\" type=radio value="+inputCfg.option[j].value+" />"+inputCfg.option[j].text}if(inputCfg.classs){inputWrap.className=inputCfg.classs+" TQMiniMess_common"}inputWrap.innerHTML+=radioHTML;mbBodyMid.appendChild(inputWrap)}}},__addInputEvent:function(el,text){if(text==''){return}el.value=text;el.onblur=function(event){if(this.value==''){this.value=text}};el.onfocus=function(event){if(this.value==text){this.value=''}}},initPosition:function(){var mbBody=TQUtils.GetObj(TQKF.mess.BODY_ID);TQKF.mess.toggle.init();mbBody.style.overflow='hidden';mbBody.style.display='none';var d=document.documentElement;this.mbWrap.style.top=d.clientHeight-this.mbWrap.clientHeight+'px';if(TQUtils.isSupportFixedPos){this.mbWrap.style.top='';this.mbWrap.style.bottom='0';this.mbWrap.style.position='fixed'}else{window.attachEvent('onscroll',this.fixPos);window.attachEvent('onresize',this.fixPos);this.fixPos()}},fixPos:function(){var self=TQKF.mess.DOM;var page=document.body;if(!TQUtils.onQuirkMode){page=page.parentNode}self.mbWrap.style.top=parseInt(TQUtils.GetWinSize().h)+parseInt(TQUtils.GetScrollTop())-self.mbWrap.offsetHeight+'px'},init:function(){TQKF.mess.DOM.append();setTimeout(function(){if(tq_language!=1&&TQKF.MessConfig.isShowCallBtnEn==0){TQUtils.GetObj(TQKF.mess.CALL_ID).style.display="none"}TQKF.mess.DOM.createFormInputs();TQKF.mess.DOM.initPosition();TQKF.mess.DOM.hideTip();if(TQKF.MessConfig.isAutoShow)TQKF.mess.toggle.autoShow()},1000)},GetLocalURL:function(){var local_url=window.location.href.replace(/\&/g,"*");if(local_url.length>100)local_url=local_url.substring(0,100);return local_url},submitValue:function(){if(TQKF.mess.submittype=="call")this.showTip("sendding",unescape(TQKF.MessResource.calling),false);else this.showTip("sendding",unescape(TQKF.MessResource.sendding),false);var paras=[];for(var i=0,l=TQKF.MessConfig.inputs.length;i<l;i++){var inputCfg=TQKF.MessConfig.inputs[i];var colValue=TQUtils.GetObj(TQKF.mess.PREFIX+inputCfg.idname).value.replace(/(^\s*)|(\s*$)/g,"");var innertip;if(inputCfg.idname=="message")innertip=TQUtils.FillInnertip(TQKF.MessConfig.message_tip);else innertip=TQUtils.FillInnertip(unescape(TQKF.MessResource.tipprefix)+inputCfg.tip);if(colValue.length>0&&colValue!=innertip){paras.push(inputCfg.idname+"="+encodeURIComponent(colValue).replace(/%/g,"^"))}}paras.push("adminid="+TQKF.mess.adminid);paras.push("siteid="+TQKF.mess.siteid);paras.push("tactic_id="+TQKF.mess.tactic_id);paras.push("uin="+TQKF.mess.uin);paras.push("submittype="+TQKF.mess.submittype);paras.push("url_local="+this.GetLocalURL());if(typeof(tq_clientid)!="undefined")paras.push("clientid="+tq_clientid);if(typeof(tq_is_message_sms)!="undefined")paras.push("is_message_sms="+tq_is_message_sms);if(typeof(tq_is_send_mail)!="undefined")paras.push("is_send_mail="+tq_is_send_mail);if(typeof(tq_language)!="undefined")paras.push("lan="+tq_language);if(!(TQUtils.IsUndefined('TQKF.clientInfo')||TQUtils.IsUndefined('TQKF.clientInfo.r'))){try{paras.push("rand="+TQKF.clientInfo.r)}catch(e){}}paras.push("nocache="+Math.random());TQUtils.LoadJS(TQKF.MessConfig.postAction+"?"+paras.join("&"))},resetFormInputs:function(){for(var i=0,l=TQKF.MessConfig.inputs.length;i<l;i++){var inputCfg=TQKF.MessConfig.inputs[i];if(inputCfg.type!='select'){var inputEl=TQUtils.GetObj(TQKF.mess.PREFIX+inputCfg.idname);if(inputCfg.idname=="message")inputEl.value=TQUtils.FillInnertip(TQKF.MessConfig.message_tip);else inputEl.value=TQUtils.FillInnertip(unescape(TQKF.MessResource.tipprefix)+inputCfg.tip)}}},showSubmitState:function(state,info){if(state==1){if(TQKF.mess.submittype=="message")this.showTip("ok",unescape(TQKF.MessResource.success),false);else this.showTip("ok",unescape(TQKF.MessResource.callsuccess),false);this.resetFormInputs()}else{if(typeof(info)=="number"){try{info=unescape(eval("TQKF.MessResource.serverErrorMsg.m"+info))}catch(e){info=unescape(TQKF.MessResource.serverErrorMsg.munknown+"_"+info)}}else{try{info=decodeURIComponent(info)}catch(e){}}if(TQKF.mess.submittype=="message")this.showTip("error",unescape(TQKF.MessResource.fail)+"\n"+info,false);else this.showTip("error",unescape(TQKF.MessResource.callFail)+"\n"+info,false)}},showTip:function(state,word,isAutoHide){if(TQKF.mess.hideTipTimer!=null)clearTimeout(TQKF.mess.hideTipTimer);var img='';if(state=="ok")img=TQKF.MessConfig.successImg;else if(state=="error")img=TQKF.MessConfig.errorImg;else if(state=="warning")img=TQKF.MessConfig.warningImg;else img=TQKF.MessConfig.sendingImg;TQUtils.GetObj(TQKF.mess.SEND_INFO_IMG_ID).src=TQKF.image_url+img;TQUtils.GetObj(TQKF.mess.SEND_INFO_WORD_ID).innerHTML=word;TQUtils.GetObj(TQKF.mess.SEND_INFO_BG_ID).style.display="";TQUtils.GetObj(TQKF.mess.SEND_INFO_CTNER_ID).style.display="";if(isAutoHide){TQKF.mess.hideTipTimer=setTimeout(TQKF.mess.DOM.hideTip,TQKF.MessConfig.tipAutoHideDelay)}},hideTip:function(){TQUtils.GetObj(TQKF.mess.SEND_INFO_BG_ID).style.display="none";TQUtils.GetObj(TQKF.mess.SEND_INFO_CTNER_ID).style.display="none"}},validate:{must:function(name,defaultValue){var colValue=TQUtils.GetObj(TQKF.mess.PREFIX+name).value.replace(/(^\s*)|(\s*$)/g,"");if(colValue.length<=0||colValue==TQUtils.FillInnertip(defaultValue)){return false}return true},email:function(value,innertip){var emailEl=TQUtils.GetObj(TQKF.mess.PREFIX+'email');if(emailEl){if(emailEl.value==innertip||emailEl.value.length==0)return true;return/^[-0-9.a-z_]+@([0-9a-z][-0-9.a-z_]+\.)+[a-z0-9]{2,4}$/.test(TQUtils.GetObj(TQKF.mess.PREFIX+'email').value)}return true},mobile:function(value,innertip){var mobileEl=TQUtils.GetObj(TQKF.mess.PREFIX+'mobile');if(mobileEl){if(mobileEl.value==innertip||mobileEl.value.length==0)return true;return/^[1]{1}[3-9]{1}[0-9]{1}[0-9]{8}$/.test(TQUtils.GetObj(TQKF.mess.PREFIX+'mobile').value)}return true},phone:function(value,innertip){var phoneEl=TQUtils.GetObj(TQKF.mess.PREFIX+'phone');if(phoneEl){if(phoneEl.value==innertip||phoneEl.value.length==0)return true;return/^[0]{1}([0-9]{10}|[0-9]{11})$/.test(TQUtils.GetObj(TQKF.mess.PREFIX+'phone').value)}return true},message:function(value,innertip){var messVal=document[TQKF.mess.FORM_NAME].getElementsByTagName('textarea')[0].value;var len=messVal.length;for(var i=0,l=len;i<l;i++){if(messVal.charCodeAt(i)>127)len++}return len<=2000},getInputCfgByIdName:function(idname){for(var i=0,l=TQKF.MessConfig.inputs.length;i<l;i++){var inputCfg=TQKF.MessConfig.inputs[i];if(inputCfg.idname==idname){return inputCfg}}return null},init:function(){var pass=true;var aetMsg=[];if(TQKF.mess.submittype=="call"||TQKF.mess.submittype=="call_custom"){var pass=false;var phoneInputCfg=TQKF.mess.validate.getInputCfgByIdName("phone");if(phoneInputCfg!=null){var phoneValue=TQUtils.GetObj(TQKF.mess.PREFIX+phoneInputCfg.idname).value.replace(/(^\s*)|(\s*$)/g,"");var phoneInnertip=TQUtils.FillInnertip(unescape(TQKF.MessResource.tipprefix)+phoneInputCfg.tip);var isPhoneValid=eval("TQKF.mess.validate."+phoneInputCfg.idname+"('"+phoneValue+"','"+phoneInnertip+"')");if(phoneValue.length>0&&phoneValue!=phoneInnertip&&isPhoneValid){pass=true}}var mobileInputCfg=TQKF.mess.validate.getInputCfgByIdName("mobile");if(!pass&&mobileInputCfg!=null){var mobileValue=TQUtils.GetObj(TQKF.mess.PREFIX+mobileInputCfg.idname).value.replace(/(^\s*)|(\s*$)/g,"");var mobileInnertip=TQUtils.FillInnertip(unescape(TQKF.MessResource.tipprefix)+mobileInputCfg.tip);var isMobileValid=eval("TQKF.mess.validate."+mobileInputCfg.idname+"('"+mobileValue+"','"+mobileInnertip+"')");if(mobileValue.length>0&&mobileValue!=mobileInnertip&&isMobileValid){pass=true}}if(!pass){TQKF.mess.DOM.showTip("warning",unescape(TQKF.MessResource.errorMsg.phoneEmpty),true);return}TQKF.mess.DOM.submitValue();return}else{var isAllNotNustAndEmpty=true;for(var i=0,l=TQKF.MessConfig.inputs.length;i<l;i++){var inputCfg=TQKF.MessConfig.inputs[i];if(inputCfg.type!='select'){var colValue=TQUtils.GetObj(TQKF.mess.PREFIX+inputCfg.idname).value.replace(/(^\s*)|(\s*$)/g,"");var innertip=TQUtils.FillInnertip(unescape(TQKF.MessResource.tipprefix)+inputCfg.tip);if(inputCfg.isMust||!inputCfg.isMust&&colValue!=innertip)isAllNotNustAndEmpty=false}}for(var i=0,l=TQKF.MessConfig.inputs.length;i<l;i++){var inputCfg=TQKF.MessConfig.inputs[i];if(inputCfg.type!='select'){var colValue=TQUtils.GetObj(TQKF.mess.PREFIX+inputCfg.idname).value.replace(/(^\s*)|(\s*$)/g,"");var innertip;if(inputCfg.idname=="message"){innertip=TQUtils.FillInnertip(TQKF.MessConfig.message_tip);if(isAllNotNustAndEmpty)inputCfg.isMust=1}else innertip=TQUtils.FillInnertip(unescape(TQKF.MessResource.tipprefix)+inputCfg.tip);if(inputCfg.isMust){if(colValue.length<=0||colValue==innertip){pass=false;aetMsg.push(unescape(TQKF.MessResource.errorMsg.notEmpty.replace("${tip}",inputCfg.tip)));continue}}if(inputCfg.maxLen&&colValue.length>0&&colValue!=innertip){if(colValue.length>inputCfg.maxLen){pass=false;aetMsg.push(unescape(TQKF.MessResource.errorMsg.tooLong.replace("${tip}",inputCfg.tip).replace("${maxLen}",inputCfg.maxLen)));continue}}if(inputCfg.isValidate&&colValue.length>0&&colValue!=innertip){var isPass=eval("TQKF.mess.validate."+inputCfg.idname+"('"+colValue+"','"+innertip+"')");if(!isPass){pass=false;aetMsg.push(unescape(TQKF.MessResource.errorMsg.invalid.replace("${tip}",inputCfg.tip)));continue}}}}}if(!pass){TQKF.mess.DOM.showTip("warning",aetMsg.join('<br>'),true);return}TQKF.mess.DOM.submitValue();return}},toggle:{init:function(){var mbBody=TQUtils.GetObj(TQKF.mess.BODY_ID);this.min=0;this.max=mbBody.offsetHeight;if(window.attachEvent&&(!TQUtils.higherThanIE6||TQUtils.onQuirkMode)&&(!window.opera)){TQKF.mess.DOM.fixPos()}TQUtils.GetObj(TQKF.mess.HEAD_ID).onclick=function(e){TQKF.mess.toggle.doTween()}},autoShow:function(){if(!TQKF.mess.toggle.initHeight){TQKF.mess.toggle.initHeight=1}var mbBody=TQUtils.GetObj(TQKF.mess.BODY_ID);mbBody.style.display='';mbBody.style.height=TQKF.mess.toggle.initHeight+'px';TQKF.mess.toggle.initHeight+=2;if(window.attachEvent&&(!TQUtils.higherThanIE6||TQUtils.onQuirkMode)&&(!window.opera)){TQKF.mess.DOM.fixPos()}if(TQKF.mess.toggle.initHeight>TQKF.mess.toggle.max){TQUtils.GetObj(TQKF.mess.HEAD_ICON_ID).className=TQKF.mess.ICON_CLOSE_CLASS+" TQMiniMess_common";if(TQKF.MessConfig.isAutoHide)setTimeout(function(){TQKF.mess.toggle.doTween()},TQKF.MessConfig.autoHideDelay);if(TQUtils.IE&&!TQUtils.higherThanIE6||(window.attachEvent&&(!TQUtils.higherThanIE6||TQUtils.onQuirkMode)&&(!window.opera))){TQUtils.GetObj(TQKF.mess.SEND_INFO_BG_ID).style.height=TQKF.mess.DOM.mbWrap.offsetHeight;TQUtils.GetObj(TQKF.mess.SEND_INFO_CTNER_ID).style.height=TQKF.mess.DOM.mbWrap.offsetHeight}}else{setTimeout(TQKF.mess.toggle.autoShow,0)}},duration:30,easeIn:function(step,duration){return Math.pow(step/duration,2)},easeOut:function(step,duration){var c=step/duration;return-c*(c-2)},doTween:function(){var from,to;var mbBody=TQUtils.GetObj(TQKF.mess.BODY_ID);if(mbBody.style.display=='none'){from=this.min;to=this.max}else{from=this.max;to=this.min}var step=0,chg=to-from;function fixPosition(){if(window.attachEvent&&(!TQUtils.higherThanIE6||TQUtils.onQuirkMode)&&(!window.opera)){TQKF.mess.DOM.fixPos()}}function doTweenStep(){var offset=TQKF.mess.toggle.easeIn(step++,TQKF.mess.toggle.duration);var hei=from+Math.floor(chg*offset);if(hei>0){mbBody.style.height=hei+'px';mbBody.style.display=''}else{mbBody.style.display='none'}if(step>TQKF.mess.toggle.duration){clearInterval(interval);TQUtils.GetObj(TQKF.mess.HEAD_ICON_ID).className=mbBody.style.display=='none'?TQKF.mess.ICON_OPEN_CLASS+" TQMiniMess_common":TQKF.mess.ICON_CLOSE_CLASS+" TQMiniMess_common";if(TQUtils.IE&&!TQUtils.higherThanIE6||(window.attachEvent&&(!TQUtils.higherThanIE6||TQUtils.onQuirkMode)&&(!window.opera))){TQUtils.GetObj(TQKF.mess.SEND_INFO_BG_ID).style.height=TQKF.mess.DOM.mbWrap.offsetHeight;TQUtils.GetObj(TQKF.mess.SEND_INFO_CTNER_ID).style.height=TQKF.mess.DOM.mbWrap.offsetHeight}}fixPosition()}var interval=setInterval(doTweenStep,10)}}};if(TQKF.userDefined.loadCSSType=="auto"){TQUtils.LoadCSS(TQKF.image_url+'images/minimess/s'+TQKF.MessConfig.style+'/c'+TQKF.MessConfig.color+'/style.css')}TQKF.mess.DOM.create();setTimeout(TQKF.mess.DOM.init,500);